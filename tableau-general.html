<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tableau G√©n√©ral - ORPI Immobilier</title>
    <link rel="icon" type="image/png" href="images.png">
    <script>
        window.BUILD_V = Math.floor(Date.now() / 3600000);
        document.write('<link rel="stylesheet" href="css/styles.css?v=' + window.BUILD_V + '">');
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .order-btn {
            background: var(--primary-color, #E30613);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 0.4rem 0.6rem;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s;
            min-width: 32px;
        }
        .order-btn:hover:not(:disabled) {
            background: #c20510;
            transform: scale(1.1);
        }
        .order-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        .order-btn i {
            font-size: 0.75rem;
        }
    </style>
</head>
<body>
    <div id="pageLoader" class="page-loader">
        <div class="loader-content">
            <div class="loader-spinner"></div>
            <div class="loader-text">ORPI Admin</div>
        </div>
    </div>

        <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <img src="images/logo-orpi-mandelieu.png" alt="ORPI Paris">
            </div>
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="index.html" class="nav-link">Accueil</a>
                </li>
                <li class="nav-item">
                    <a href="biens.html" class="nav-link">Nos Biens</a>
                </li>
                <li class="nav-item" id="tableauGeneralLink" style="display: none;">
                    <a href="tableau-general.html" class="nav-link active">Tableau G√©n√©ral</a>
                </li>
                <li class="nav-item">
                    <a href="contact.html" class="nav-link">Contact</a>
                </li>
                <li class="nav-item">
                    <a href="estimation.html" class="nav-link">Estimation</a>
                </li>
                                <li class="nav-item" id="adminPanel" style="display: none;">
                    <a href="admin.html" class="nav-link admin-link">
                        <i class="fas fa-shield-alt"></i> Panel Administration
                    </a>
                </li>
            </ul>
                        <span class="notifications-text" id="notificationsText" style="display: none;"></span>
                        <div class="notifications-btn" id="notificationsBtn" style="display: none;" onclick="toggleNotifications()">
                <i class="fas fa-bell"></i>
                <span class="notifications-badge" id="notificationsBadge" style="display: none;">0</span>
            </div>
                        <div class="user-profile" id="userProfile" style="display: none;">
                <img id="userAvatar" src="" alt="Avatar" class="user-avatar">
                <span id="userName" class="user-name"></span>
                <button onclick="logout()" class="logout-btn" title="D√©connexion">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
                        <button id="loginBtn" class="discord-login-btn" onclick="loginWithDiscord()">
                <i class="fab fa-discord"></i> Connexion
            </button>
            <div class="nav-toggle" id="navToggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

        <section class="tableau-section">
        <div class="container-fluid">
            <div class="tableau-header">
                <h1 class="section-title">Tableau G√©n√©ral - Totaux / Salaires</h1>
                <div class="tableau-actions">
                    <a href="admin.html" class="btn btn-primary">
                        <i class="fas fa-shield-alt"></i> Panel Administration
                    </a>
                    <button id="refreshBtn" class="btn btn-secondary">
                        <span>üîÑ</span> Actualiser
                    </button>
                </div>
            </div>

                        <div class="summary-cards">
                <div class="summary-card">
                    <div class="summary-icon">üë•</div>
                    <div class="summary-content">
                        <div class="summary-value" id="totalEmployees">0</div>
                        <div class="summary-label">Employ√©s</div>
                    </div>
                </div>
                <div class="summary-card">
                    <div class="summary-icon">üìä</div>
                    <div class="summary-content">
                        <div class="summary-value" id="totalVentes">0</div>
                        <div class="summary-label">Ventes Totales</div>
                    </div>
                </div>
                <div class="summary-card">
                    <div class="summary-icon">üí∞</div>
                    <div class="summary-content">
                        <div class="summary-value" id="totalCA">0 ‚Ç¨</div>
                        <div class="summary-label">Chiffre d'Affaires</div>
                    </div>
                </div>
                <div class="summary-card">
                    <div class="summary-icon">üè¶</div>
                    <div class="summary-content">
                        <div class="summary-value" id="totalEntrepriseRevenue" style="color: #28a745;">0 ‚Ç¨</div>
                        <div class="summary-label">Coffre Entreprise (15%)</div>
                    </div>
                </div>
                <div class="summary-card">
                    <div class="summary-icon">üíµ</div>
                    <div class="summary-content">
                        <div class="summary-value" id="totalSalaires">0 ‚Ç¨</div>
                        <div class="summary-label">Salaires Totaux</div>
                    </div>
                </div>
            </div>

                        <div class="tableau-container">
                <div class="tableau-scroll">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th style="width: 80px;">Ordre</th>
                                <th>Nom</th>
                                <th>Grade</th>
                                <th>Fiche</th>
                                <th>Total B√©n√©fices</th>
                                <th>Total Vente</th>
                                <th>NB Vente</th>
                                <th>Primes</th>
                                <th>Dividendes</th>
                                <th>Salaire</th>
                                <th>Salaire √† Verser</th>
                            </tr>
                        </thead>
                        <tbody id="employeesTableBody">
                            <tr>
                                <td colspan="11" class="text-center">
                                    <div class="loading">Chargement des donn√©es...</div>
                                </td>
                            </tr>
                        </tbody>
                        <tfoot id="tableFooter">
                            <tr class="total-row">
                                <td></td>
                                <td colspan="2"><strong>TOTAL</strong></td>
                                <td id="footerTotalBenefices">0 ‚Ç¨</td>
                                <td id="footerTotalVente">0 ‚Ç¨</td>
                                <td id="footerNbVente">0</td>
                                <td id="footerPrimes">0 ‚Ç¨</td>
                                <td id="footerDividendes">0 ‚Ç¨</td>
                                <td id="footerSalaire">0 ‚Ç¨</td>
                                <td id="footerSalaireAVerser">0 ‚Ç¨</td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>

                        <div class="salaire-info">
                <p class="info-text">üí° Modifier que les colonnes gris clair (Primes et Dividendes)</p>
            </div>
        </div>
    </section>

        <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h3>ORPI Immobilier</h3>
                <p>Votre partenaire immobilier de confiance √† Paris</p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2024 ORPI Immobilier Paris. Tous droits r√©serv√©s.</p>
        </div>
    </footer>

    <div id="notificationsModal" class="modal">
        <div class="modal-content notifications-modal">
            <div class="modal-header">
                <h2>Notifications</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="notifications-actions">
                <button id="markAllReadBtn" class="btn-secondary">Tout marquer comme lu</button>
            </div>
            <div id="notificationsList" class="notifications-list">
                <div class="loading">Chargement...</div>
            </div>
        </div>
    </div>

        <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    
        <script src="js/firebase-config.js"></script>
    <script src="js/firebase-theme.js"></script>
    <script src="js/firebase-employees.js"></script>
    <script src="js/firebase-sales.js"></script>
    <script src="js/firebase-notifications.js"></script>
    <script>
        const v = Date.now();
        document.write('<script src="js/config.js?v=' + v + '"><\/script>');
        document.write('<script src="js/theme.js?v=' + v + '"><\/script>');
        document.write('<script src="js/auth.js?v=' + v + '"><\/script>');
        document.write('<script src="js/notifications.js?v=' + v + '"><\/script>');
        document.write('<script src="js/toast-notifications.js?v=' + v + '"><\/script>');
        document.write('<script src="js/page-loader.js?v=' + v + '"><\/script>');
        document.write('<script src="js/tableau-general.js?v=' + v + '"><\/script>');
        document.write('<script src="js/script.js?v=' + v + '"><\/script>');
    </script>
</body>
</html>

